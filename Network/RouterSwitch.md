# 라우터와 스위치
작은 사무실 네트워크를 구축할 때는 가장 필수적인 두 가지 장비가 스위치와 라우터이다. 두 디바이스는 비슷해 보이지만 네트워크 내에서 각기 다른 기능을 수행한다.

### 네트워크 스위치
네트워크 스위치는 OSI 모델의 데이터링크 계층(2계층)에서 작동한다. 스위치는 소규모 비즈니스 네트워크 안에서 컴퓨터, 프린터, 서버 등 모든 디바이스를 서로 연결함으로써 리소스를 쉽게 공유할 수 있도록 한다. 스위치 덕에 연결된 디바이스는 건물 안이든 캠퍼스 안이든 관계없이 정보를 공유하고 서로 통신할 수 있다.  
스위치는 물리적 포트에 연결된 기기에서 전송된 패킷을 받아 다시 내보낸다. 단, 패킷이 도달해야 하는 기기로 이어지는 포트를 통해서만 보낸다. 스위치는 이더넷, 파이버 채널, 비동기 전송 모드(ATM) 및 인피니밴드(InfiniBand) 등을 기반으로 하는데, 현재는 대부분의 스위치가 이더넷을 사용한다.

<br>

### 네트워크 스위치 작동 원리
기기가 스위치에 연결되면 스위치는 해당 이더넷 케이블에 연결된 기기의 네트워크 인터페이스 카드(NIC)에 내장된 미디어 액세스 제어(MAC) 주소를 확인한다. 스위치는 이 MAC 주소를 사용해 패킷이 발송된 기기와 수신된 패킷을 전달할 위치를 식별한다. 따라서 MAC 주소는 기기에 동적으로 할당되고 변경이 가능한 네트워크 계층(3계층) IP 주소와 달리 물리적 기기를 식별하는데 쓰인다.  

한 기기가 다른 기기로 패킷을 보내면 패킷이 스위치로 들어오고 스위치는 패킷의 헤더를 읽어 어떻게 처리할지 결정한다. 목적지 주소와 대조해 목적지 기기로 이어지는 적절한 포트를 통해 패킷을 내보낸다.  

이 과정에서 스위치와 스위치에 연결된 기기에서 동시에 전송되고 수신되는 네트워크 트래픽 간의 충돌 가능성이 있어, 대부분의 스위치는 기기를 오가는 패킷이 스위치 연결 전체 대역폭에 액세스할 수 있도록 하는 전이중(full-duplex) 기능을 제공한다. 두 사람이 무전기가 아닌 휴대전화로 대화하는 모습이라고 생각하면 된다.  

한편 대부분의 스위치가 2계층에서 작동하지만 일부 스위치는 3계층에서도 작동할 수 있다. 이러한 스위치를 계층 3 스위치라고 하며 가상LAN(VLAN) 구성과 같은 부가 기능을 제공한다.

<br>

### 스위치 vs 허브
허브도 리소스 공유를 목적으로 여러 기기를 하나로 연결한다. 허브에 연결된 기기 집단을 LAN 세그먼트라고 한다. 허브가 스위치와 다른 점은 연결된 기기 중 하나에서 전송된 패킷이 허브에 연결된 모든 기기로 브로드 캐스팅된다는 점이다.  

반면 스위치는 패킷의 목적지 주소로 지정된 기기로 이어지는 포트로만 패킷이 전달된다. 또한 스위치는 일반적으로 LAN 세그먼트와 세그먼트에 연결된 허브를 연결한다. 스위치는 동일한 LAN 세그먼트의 기기를 향하는 트래픽을 걸러낸다. 이러한 기능 덕에 스위치는 자체 프로세싱 리소스와 네트워크 대역폭을 더 효율적으로 활용한다.

<br>

### 라우터
스위치가 여러 디바이스를 연결하여 네트워크를 만들 듯, 라우터는 여러 스위치와 각각의 네트워크들을 연결하여 더 큰 네트워크를 형성한다. 이러한 네트워크는 한 곳에 있을 수도 있고 여러 곳에 분산되어 있을 수도 있다. 소규모 비즈니스 네트워크를 구축할 때는 하나 이상의 라우터가 필요하다. 여러 네트워크를 서로 연결하는 것 외에도 라우터는 네트워크 디바이스 및 여러 사용자가 인터넷에 액세스하는 것도 허용한다.  

궁극적으로 라우터는 트래픽을 전달하고 정보의 가장 효율적인 경로를 선택하는 디스패처 역할을 한다. 정보는 데이터 패킷의 형태로 네트워크를 거쳐 이동한다. 라우터는 회사를 세계와 연결하고 보안 위협으로부터 정보를 보호하며, 우선 순위를 가질 디바이스를 결정하기도 한다.

<br>

### 스위치 vs 라우터
먼저 정리하자면 !  

**스위치**
- 목적지로 출발한 데이터를 중간에 적합한 경로로 스위칭해주는 역할
- 데이터링크 계층에 속함
- 즉 MAC 주소 기반으로 동작

**라우터**
- 목적지로 가는 적합한 경로를 찾아주는 라우팅 기능의 역할
- 네트워크 계층에 속함
- 즉 IP 주소를 기반으로 동작

**차이**
- 계층
  - 스위치: 데이터링크 계층에서 MAC주소를 기반으로 동작
  - 라우터: 네트워크 계층에서 IP주소를 기반으로 동작
- 브로드캐스트 도메인
  - 스위치는 브로드캐스트 도메인을 구분할 수 없지만, 라우터는 브로드캐스트 도메인을 구분하여 서로 다른 네트워크 대역을 구분한다.
- 불명확한 목적지의 데이터
  - 스위치는 불명확한 목적지를 가진 데이터를 처리할 때 모든 포트로 데이터를 퍼뜨리는 브로드캐스트를 하지만, 라우터는 해당 데이터를 버린다.
- 관리자 설정
  - 스위치는 관리자의 설정이 필요 없지만 라우터는 관리자의 설정으로 라우팅 테이블 생성과 통신을 해야 한다.

*브로드캐스트*  
- 1:전체
- 로컬 LAN 상에 붙어 있는(브로드캐스트 도메인 안에 있는) 모든 네트워크 장비들에게 보내는 통신
- 동네 이장님이 마이크로 "동네 사람들 모이세요!"라고 방송하는 것과 동일하다. 이때 동네(방송을 듣는 영역)는 브로드캐스트 도메인과 같다.
- 이 주소로 CPU가 패킷을 받으면 무조건 읽는다. (원래 자신의 MAC주소와 목적지 주소가 다르면 버린다.)
- 브로드캐스트는 네트워크 상의 전체 노드로 전송되기 때문에 전체 트래픽이 증가한다
- 이 패킷을 받은 CPU는 패킷을 처리하게 되고 PC의 성능도 떨어진다.
- 즉, 과도한 브로드캐스트는 전체 네트워크 성능 뿐만 아니라 PC 성능도 떨어지게 한다.

<br>

#### 참고
[네트워크 스위치와 허브, 라우터는 어떻게 다른 걸까](https://www.itworld.co.kr/tags/1354/%EC%8A%A4%EC%9C%84%EC%B9%98/167585)   
[스위치와 라우터란?](https://www.cisco.com/c/ko_kr/solutions/small-business/resource-center/networking/network-switch-vs-router.html#~routers)  
[스위치, 라우터 차이-velog](https://velog.io/@jihoon97/%EC%8A%A4%EC%9C%84%EC%B9%98-%EB%9D%BC%EC%9A%B0%ED%84%B0%EC%9D%98-%EC%B0%A8%EC%9D%B4)  
[브로드캐스트(Broadcast)란?](https://velog.io/@ragnarok_code/%EB%B8%8C%EB%A1%9C%EB%93%9C%EC%BA%90%EC%8A%A4%ED%8A%B8Broadcast%EB%9E%80)
